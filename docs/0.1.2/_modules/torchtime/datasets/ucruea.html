


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>torchtime.datasets.ucruea &mdash; Torchtime nightly documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/logo-icon.svg"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/katex-math.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sg_gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sg_gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sg_gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sg_gallery-rendered-html.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <!-- Google Tag Manager -->
  
    <!-- End Google Tag Manager -->
  

  
  <script src="../../../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorchtime.com/docs/stable/index.html" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorchtime.com/docs/stable/get-started.html">Get Started</a>
          </li>

          <li>
            <a href="https://pytorchtime.com/docs/stable/tutorials/">Tutorials</a>
          </li>

          <li>
            <a href="https://pytorchtime.com/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <a href="https://github.com/VincentSch4rf/torchtime">GitHub</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            
    <div class="version">
      <a href="../../../../versions.html"><span style="font-size:110%">Nightly Build (0.1.1+3666d22) &#x25BC</span></a>
    </div>
    


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          </div>

          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Torchtime Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../get-started.html">Get Started</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/classification_tutorial.html">Time Series Classification with InceptionTime</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../torchtime.html">torchtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../io.html">torchtime.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../datasets.html">torchtime.datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../transforms.html">torchtime.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../models.html">torchtime.models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PyTorch Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/docs">PyTorch</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/audio">torchaudio</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/text">torchtext</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/vision">torchvision</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/elastic/">TorchElastic</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pytorch.org/serve">TorchServe</a></li>
<li class="toctree-l1"><a class="reference external" href="http://pytorch.org/xla/">PyTorch on XLA Devices</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="../../index.html">Module code</a> &gt;</li>
        
      <li>torchtime.datasets.ucruea</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
    
    
          
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <h1>Source code for torchtime.datasets.ucruea</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">URLError</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">Tensor</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">TimeSeriesDataset</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">download_and_extract_archive</span>
<span class="kn">from</span> <span class="nn">..exceptions</span> <span class="kn">import</span> <span class="n">DataConversionWarning</span>
<span class="kn">from</span> <span class="nn">..io.arff</span> <span class="kn">import</span> <span class="n">load_from_arff_to_dataframe</span>
<span class="kn">from</span> <span class="nn">..io.ts</span> <span class="kn">import</span> <span class="n">TSFileLoader</span>
<span class="kn">from</span> <span class="nn">..transforms</span> <span class="kn">import</span> <span class="n">functional</span> <span class="k">as</span> <span class="n">F</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">stack_pad</span>


<div class="viewcode-block" id="UCR"><a class="viewcode-back" href="../../../generated/torchtime.datasets.UCR.html#torchtime.datasets.UCR">[docs]</a><span class="k">class</span> <span class="nc">UCR</span><span class="p">(</span><span class="n">TimeSeriesDataset</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;*UEA &amp; UCR Time Series Classification Repository* :cite:`Dau2019UCR`.</span>

<span class="sd">    Args:</span>
<span class="sd">        root (str): Root directory of dataset where ``UCR/&lt;dataset_name&gt;`` exist.</span>
<span class="sd">        name (str): The name of the dataset to load from the UCR archive.</span>
<span class="sd">        train (bool, optional): If True, creates dataset from ``TRAIN.ts`` or ``TRAIN.arff``, otherwise from</span>
<span class="sd">            ``TEST.ts`` or ``TEST.arff``.</span>
<span class="sd">        download (bool, optional): If true, downloads the dataset from the internet and puts it in root directory.</span>
<span class="sd">            If dataset is already downloaded, it is not downloaded again.</span>
<span class="sd">        classes (list, optional): A list containing the class labels, where the index in the list indicates the numeric</span>
<span class="sd">            value it should be mapped to.</span>
<span class="sd">        transform (callable, optional): A function/transform that  takes in a uni- or multivariate time series and</span>
<span class="sd">            returns a transformed version. E.g, ``transforms.NaN2Value``</span>
<span class="sd">        target_transform (callable, optional): A function/transform that takes in the target and transforms it.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_repr_indent</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="n">mirrors</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;http://timeseriesclassification.com/aeon-toolkit/&#39;</span>
    <span class="p">]</span>

    <span class="n">univariate</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;AbnormalHeartbeat&#39;</span><span class="p">,</span> <span class="s1">&#39;ACSF1&#39;</span><span class="p">,</span> <span class="s1">&#39;Adiac&#39;</span><span class="p">,</span> <span class="s1">&#39;AllGestureWiimoteX&#39;</span><span class="p">,</span> <span class="s1">&#39;AllGestureWiimoteY&#39;</span><span class="p">,</span>
        <span class="s1">&#39;AllGestureWiimoteZ&#39;</span><span class="p">,</span> <span class="s1">&#39;ArrowHead&#39;</span><span class="p">,</span> <span class="s1">&#39;Beef&#39;</span><span class="p">,</span> <span class="s1">&#39;BeetleFly&#39;</span><span class="p">,</span> <span class="s1">&#39;BirdChicken&#39;</span><span class="p">,</span>
        <span class="s1">&#39;BME&#39;</span><span class="p">,</span> <span class="s1">&#39;Car&#39;</span><span class="p">,</span> <span class="s1">&#39;CBF&#39;</span><span class="p">,</span> <span class="s1">&#39;Chinatown&#39;</span><span class="p">,</span> <span class="s1">&#39;ChlorineConcentration&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CinCECGTorso&#39;</span><span class="p">,</span> <span class="s1">&#39;Coffee&#39;</span><span class="p">,</span> <span class="s1">&#39;Computers&#39;</span><span class="p">,</span> <span class="s1">&#39;CricketX&#39;</span><span class="p">,</span> <span class="s1">&#39;CricketY&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CricketZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Crop&#39;</span><span class="p">,</span> <span class="s1">&#39;DiatomSizeReduction&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DistalPhalanxOutlineAgeGroup&#39;</span><span class="p">,</span> <span class="s1">&#39;DistalPhalanxOutlineCorrect&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DistalPhalanxTW&#39;</span><span class="p">,</span> <span class="s1">&#39;DodgerLoopDay&#39;</span><span class="p">,</span> <span class="s1">&#39;DodgerLoopGame&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DodgerLoopWeekend&#39;</span><span class="p">,</span> <span class="s1">&#39;Earthquakes&#39;</span><span class="p">,</span> <span class="s1">&#39;ECG200&#39;</span><span class="p">,</span> <span class="s1">&#39;ECG5000&#39;</span><span class="p">,</span> <span class="s1">&#39;ECGFiveDays&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ElectricDevices&#39;</span><span class="p">,</span> <span class="s1">&#39;EOGHorizontalSignal&#39;</span><span class="p">,</span> <span class="s1">&#39;EOGVerticalSignal&#39;</span><span class="p">,</span>
        <span class="s1">&#39;EthanolLevel&#39;</span><span class="p">,</span> <span class="s1">&#39;FaceAll&#39;</span><span class="p">,</span> <span class="s1">&#39;FaceFour&#39;</span><span class="p">,</span> <span class="s1">&#39;FacesUCR&#39;</span><span class="p">,</span> <span class="s1">&#39;FiftyWords&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Fish&#39;</span><span class="p">,</span> <span class="s1">&#39;FordA&#39;</span><span class="p">,</span> <span class="s1">&#39;FordB&#39;</span><span class="p">,</span> <span class="s1">&#39;FreezerRegularTrain&#39;</span><span class="p">,</span> <span class="s1">&#39;FreezerSmallTrain&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Fungi&#39;</span><span class="p">,</span> <span class="s1">&#39;GestureMidAirD1&#39;</span><span class="p">,</span> <span class="s1">&#39;GestureMidAirD2&#39;</span><span class="p">,</span> <span class="s1">&#39;GestureMidAirD3&#39;</span><span class="p">,</span>
        <span class="s1">&#39;GesturePebbleZ1&#39;</span><span class="p">,</span> <span class="s1">&#39;GesturePebbleZ2&#39;</span><span class="p">,</span> <span class="s1">&#39;GunPoint&#39;</span><span class="p">,</span> <span class="s1">&#39;GunPointAgeSpan&#39;</span><span class="p">,</span>
        <span class="s1">&#39;GunPointMaleVersusFemale&#39;</span><span class="p">,</span> <span class="s1">&#39;GunPointOldVersusYoung&#39;</span><span class="p">,</span> <span class="s1">&#39;Ham&#39;</span><span class="p">,</span>
        <span class="s1">&#39;HandOutlines&#39;</span><span class="p">,</span> <span class="s1">&#39;Haptics&#39;</span><span class="p">,</span> <span class="s1">&#39;Herring&#39;</span><span class="p">,</span> <span class="s1">&#39;HouseTwenty&#39;</span><span class="p">,</span> <span class="s1">&#39;InlineSkate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;InsectEPGRegularTrain&#39;</span><span class="p">,</span> <span class="s1">&#39;InsectEPGSmallTrain&#39;</span><span class="p">,</span> <span class="s1">&#39;InsectWingbeatSound&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ItalyPowerDemand&#39;</span><span class="p">,</span> <span class="s1">&#39;LargeKitchenAppliances&#39;</span><span class="p">,</span> <span class="s1">&#39;Lightning2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Lightning7&#39;</span><span class="p">,</span> <span class="s1">&#39;Mallat&#39;</span><span class="p">,</span> <span class="s1">&#39;Meat&#39;</span><span class="p">,</span> <span class="s1">&#39;MedicalImages&#39;</span><span class="p">,</span> <span class="s1">&#39;MelbournePedestrian&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MiddlePhalanxOutlineAgeGroup&#39;</span><span class="p">,</span> <span class="s1">&#39;MiddlePhalanxOutlineCorrect&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MiddlePhalanxTW&#39;</span><span class="p">,</span> <span class="s1">&#39;MixedShapesRegularTrain&#39;</span><span class="p">,</span> <span class="s1">&#39;MixedShapesSmallTrain&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MoteStrain&#39;</span><span class="p">,</span> <span class="s1">&#39;NonInvasiveFetalECGThorax1&#39;</span><span class="p">,</span>
        <span class="s1">&#39;NonInvasiveFetalECGThorax2&#39;</span><span class="p">,</span> <span class="s1">&#39;OliveOil&#39;</span><span class="p">,</span> <span class="s1">&#39;OSULeaf&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PhalangesOutlinesCorrect&#39;</span><span class="p">,</span> <span class="s1">&#39;Phoneme&#39;</span><span class="p">,</span> <span class="s1">&#39;PickupGestureWiimoteZ&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PigAirwayPressure&#39;</span><span class="p">,</span> <span class="s1">&#39;PigArtPressure&#39;</span><span class="p">,</span> <span class="s1">&#39;PigCVP&#39;</span><span class="p">,</span> <span class="s1">&#39;PLAID&#39;</span><span class="p">,</span> <span class="s1">&#39;Plane&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PowerCons&#39;</span><span class="p">,</span> <span class="s1">&#39;ProximalPhalanxOutlineAgeGroup&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ProximalPhalanxOutlineCorrect&#39;</span><span class="p">,</span> <span class="s1">&#39;ProximalPhalanxTW&#39;</span><span class="p">,</span>
        <span class="s1">&#39;RefrigerationDevices&#39;</span><span class="p">,</span> <span class="s1">&#39;Rock&#39;</span><span class="p">,</span> <span class="s1">&#39;ScreenType&#39;</span><span class="p">,</span> <span class="s1">&#39;SemgHandGenderCh2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;SemgHandMovementCh2&#39;</span><span class="p">,</span> <span class="s1">&#39;SemgHandSubjectCh2&#39;</span><span class="p">,</span> <span class="s1">&#39;ShakeGestureWiimoteZ&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ShapeletSim&#39;</span><span class="p">,</span> <span class="s1">&#39;ShapesAll&#39;</span><span class="p">,</span> <span class="s1">&#39;SmallKitchenAppliances&#39;</span><span class="p">,</span> <span class="s1">&#39;SmoothSubspace&#39;</span><span class="p">,</span>
        <span class="s1">&#39;SonyAIBORobotSurface1&#39;</span><span class="p">,</span> <span class="s1">&#39;SonyAIBORobotSurface2&#39;</span><span class="p">,</span> <span class="s1">&#39;StarLightCurves&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Strawberry&#39;</span><span class="p">,</span> <span class="s1">&#39;SwedishLeaf&#39;</span><span class="p">,</span> <span class="s1">&#39;Symbols&#39;</span><span class="p">,</span> <span class="s1">&#39;SyntheticControl&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ToeSegmentation1&#39;</span><span class="p">,</span> <span class="s1">&#39;ToeSegmentation2&#39;</span><span class="p">,</span> <span class="s1">&#39;Trace&#39;</span><span class="p">,</span> <span class="s1">&#39;TwoLeadECG&#39;</span><span class="p">,</span>
        <span class="s1">&#39;TwoPatterns&#39;</span><span class="p">,</span> <span class="s1">&#39;UMD&#39;</span><span class="p">,</span> <span class="s1">&#39;UWaveGestureLibraryAll&#39;</span><span class="p">,</span> <span class="s1">&#39;UWaveGestureLibraryX&#39;</span><span class="p">,</span>
        <span class="s1">&#39;UWaveGestureLibraryY&#39;</span><span class="p">,</span> <span class="s1">&#39;UWaveGestureLibraryZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Wafer&#39;</span><span class="p">,</span> <span class="s1">&#39;Wine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;WordSynonyms&#39;</span><span class="p">,</span> <span class="s1">&#39;Worms&#39;</span><span class="p">,</span> <span class="s1">&#39;WormsTwoClass&#39;</span><span class="p">,</span> <span class="s1">&#39;Yoga&#39;</span>
    <span class="p">]</span>

    <span class="n">multivariate</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;ArticularyWordRecognition&#39;</span><span class="p">,</span> <span class="s1">&#39;AtrialFibrillation&#39;</span><span class="p">,</span> <span class="s1">&#39;BasicMotions&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CharacterTrajectories&#39;</span><span class="p">,</span> <span class="s1">&#39;Cricket&#39;</span><span class="p">,</span> <span class="s1">&#39;DuckDuckGeese&#39;</span><span class="p">,</span> <span class="s1">&#39;EigenWorms&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Epilepsy&#39;</span><span class="p">,</span> <span class="s1">&#39;ERing&#39;</span><span class="p">,</span> <span class="s1">&#39;EthanolConcentration&#39;</span><span class="p">,</span> <span class="s1">&#39;FaceDetection&#39;</span><span class="p">,</span>
        <span class="s1">&#39;FingerMovements&#39;</span><span class="p">,</span> <span class="s1">&#39;HandMovementDirection&#39;</span><span class="p">,</span> <span class="s1">&#39;Handwriting&#39;</span><span class="p">,</span> <span class="s1">&#39;Heartbeat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;InsectWingbeat&#39;</span><span class="p">,</span> <span class="s1">&#39;JapaneseVowels&#39;</span><span class="p">,</span> <span class="s1">&#39;Libras&#39;</span><span class="p">,</span> <span class="s1">&#39;LSST&#39;</span><span class="p">,</span> <span class="s1">&#39;MotorImagery&#39;</span><span class="p">,</span>
        <span class="s1">&#39;NATOPS&#39;</span><span class="p">,</span> <span class="s1">&#39;PEMS-SF&#39;</span><span class="p">,</span> <span class="s1">&#39;PenDigits&#39;</span><span class="p">,</span> <span class="s1">&#39;PhonemeSpectra&#39;</span><span class="p">,</span> <span class="s1">&#39;RacketSports&#39;</span><span class="p">,</span>
        <span class="s1">&#39;SelfRegulationSCP1&#39;</span><span class="p">,</span> <span class="s1">&#39;SelfRegulationSCP2&#39;</span><span class="p">,</span> <span class="s1">&#39;SpokenArabicDigits&#39;</span><span class="p">,</span>
        <span class="s1">&#39;StandWalkJump&#39;</span><span class="p">,</span> <span class="s1">&#39;UWaveGestureLibrary&#39;</span>
    <span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">training_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_TRAIN&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">test_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_TEST&quot;</span>

    <span class="n">archive_format</span> <span class="o">=</span> <span class="s2">&quot;.zip&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">channels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">root</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">train</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">download</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">UCR</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train</span> <span class="o">=</span> <span class="n">train</span>  <span class="c1"># training set or test set</span>
        <span class="k">if</span> <span class="n">classes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">classes</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Class mapping contains duplicate labels!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">classes</span>

        <span class="k">if</span> <span class="n">download</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Dataset not found. You can use download=True to download it&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_data</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">training_file</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">train</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_file</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.ts&quot;</span>
        <span class="n">abspath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">abspath</span><span class="p">):</span>
            <span class="n">file_loader</span> <span class="o">=</span> <span class="n">TSFileLoader</span><span class="p">(</span><span class="n">abspath</span><span class="p">)</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">file_loader</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">return_targets</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">classes</span> <span class="o">=</span> <span class="n">file_loader</span><span class="o">.</span><span class="n">get_classes</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="p">(</span><span class="n">file_loader</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">file_loader</span><span class="o">.</span><span class="n">series_length</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">training_file</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">train</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_file</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.arff&quot;</span>
            <span class="n">abspath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">classes</span> <span class="o">=</span> <span class="n">load_from_arff_to_dataframe</span><span class="p">(</span><span class="n">abspath</span><span class="p">,</span> <span class="n">return_class_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">data_</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                <span class="c1"># to_time_series_dataset(data[f&#39;dim_{i}&#39;])</span>
                <span class="n">data_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stack_pad</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;dim_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]))</span>  <span class="c1"># stack arrays even if they have different lengths</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">data_</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="c1"># data = match_seq_len(data)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">classes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of classes present in </span><span class="si">{}</span><span class="s2"> is different from the provided class mapping.&quot;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">abspath</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">!=</span> <span class="n">classes</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The classes provided do not match the classes from the dataset!&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># targets = list(map(int, targets))</span>
            <span class="n">targets</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">classes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">classes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">encode_labels</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">classes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Labels are not numeric and no explicit class mapping is provided. &quot;</span>
                                  <span class="s2">&quot;Please pass an explicit class mapping to the constructor. &quot;</span>
                                  <span class="s2">&quot;Using class labels parsed from dataset.&quot;</span><span class="p">,</span>
                                  <span class="n">DataConversionWarning</span><span class="p">,</span>
                                  <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">encode_labels</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Dataset did not include explicit class labels. Inferring class labels from targets.&quot;</span><span class="p">,</span>
                                  <span class="n">DataConversionWarning</span><span class="p">,</span>
                                  <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">classes</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">encode_labels</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">classes</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">classes</span>

    <span class="k">def</span> <span class="nf">_ensure_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove nested data directory, which seems to exist for some UCR/UEA time series datasets&quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="n">os</span><span class="o">.</span><span class="n">scandir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">)</span> <span class="k">as</span> <span class="n">d</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()</span> <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                    <span class="k">with</span> <span class="n">os</span><span class="o">.</span><span class="n">scandir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="k">as</span> <span class="n">nested_dir</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">nested_dir</span><span class="p">:</span>
                            <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">)</span>
                    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_check_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># TODO: maybe get rid of multiple archive extractions and check ts/arff file checksum instead</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">)</span>
        <span class="c1"># contents = [f for f in os.listdir(self.data_dir) if os.path.isfile(os.path.join(self.data_dir, f))]</span>

    <span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Download the UCR/UEA data if it doesn&#39;t exist already.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_exists</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># download files</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">archive_format</span>
        <span class="k">for</span> <span class="n">mirror</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mirrors</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mirror</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
                <span class="n">download_and_extract_archive</span><span class="p">(</span>
                    <span class="n">url</span><span class="p">,</span> <span class="n">download_root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span>
                    <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                    <span class="n">md5</span><span class="o">=</span><span class="kc">None</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_structure</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">URLError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;Failed to download (trying next):</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">BadZipFile</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">):</span>
                    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Invalid dataset name! &quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot;Please make sure the dataset &quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;is available on http://timeseriesclassification.com/.&quot;</span><span class="p">,</span>
                <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">()</span>
            <span class="k">break</span>

<div class="viewcode-block" id="UCR.__getitem__"><a class="viewcode-back" href="../../../generated/torchtime.datasets.UCR.html#torchtime.datasets.UCR.__getitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            index (int): The index of the sample to return.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple: (series, target) where target is index of the target class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">series</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">targets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transforms</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">series</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transforms</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">series</span><span class="p">,</span> <span class="n">target</span></div>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">extra_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Dataset: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> \
               <span class="s2">&quot;Split: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Train&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">train</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="s2">&quot;Test&quot;</span><span class="p">)</span></div>
</pre></div>

             </article>
             
            </div>
            <script type="text/javascript">
  var collapsedSections = ['API Tutorials', 'Pipeline Tutorials', 'Training Recipes']
</script>
<footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2024, Vincent Scharf.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>


        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              
            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
         <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
         <script src="../../../_static/jquery.js"></script>
         <script src="../../../_static/underscore.js"></script>
         <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
         <script src="../../../_static/doctools.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js"></script>
         <script src="../../../_static/katex_autorenderer.js"></script>
     

  

  <script type="text/javascript" src="../../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <script type="text/javascript">
    var collapsedSections = ['API Tutorials', 'Tutorials', 'Training Recipes']
    </script>
     
    <script type="text/javascript">
      $(document).ready(function() {
	  var downloadNote = $(".sphx-glr-download-link-note.admonition.note");
	  if (downloadNote.length >= 1) {
	      var tutorialUrl = $("#tutorial-type").text();
	      var githubLink = "https://github.com/vincentsch4rf/torchtime/blob/main/examples/"  + tutorialUrl + ".py",
		  notebookLink = $(".reference.download")[1].href,
		  notebookDownloadPath = notebookLink.split('_downloads')[1],
		  colabLink = "https://colab.research.google.com/github/vincentsch4rf/torchtime/blob/gh-pages/main/_downloads" + notebookDownloadPath;

	      $(".pytorch-call-to-action-links a[data-response='Run in Google Colab']").attr("href", colabLink);
	      $(".pytorch-call-to-action-links a[data-response='View on Github']").attr("href", githubLink);
	  }

          var overwrite = function(_) {
              if ($(this).length > 0) {
                  $(this)[0].href = "https://github.com/vincentsch4rf/torchtime"
              }
          }
          // PC
          $(".main-menu a:contains('GitHub')").each(overwrite);
          // Mobile
          $(".main-menu a:contains('Github')").each(overwrite);
      });

      
       $(window).ready(function() {
           var original = window.sideMenus.bind;
           var startup = true;
           window.sideMenus.bind = function() {
               original();
               if (startup) {
                   $("#pytorch-right-menu a.reference.internal").each(function(i) {
                       if (this.classList.contains("not-expanded")) {
                           this.nextElementSibling.style.display = "block";
                           this.classList.remove("not-expanded");
                           this.classList.add("expanded");
                       }
                   });
                   startup = false;
               }
           };
       });
    </script>

<!--  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebooks Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../../../_static/images/pytorch-x.svg">
  </div>
</div>-->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorchtime.com/docs/stable/index.html" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorchtime.com/docs/stable/get-started.html">Get Started</a>
          </li>

          <li>
            <a href="https://pytorchtime.com/docs/stable/tutorials/">Tutorials</a>
          </li>

          <li>
            <a href="https://pytorchtime.com/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <a href="https://github.com/VincentSch4rf/torchtime">GitHub</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>